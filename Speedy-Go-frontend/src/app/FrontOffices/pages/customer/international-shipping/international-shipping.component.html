<!-- International Shipping Header Section -->
<div class="container-fluid shipping-header py-4">
  <div class="container">
    <div class="text-center wow bounceInUp" data-wow-delay="0.1s">
      <small class="d-inline-block fw-bold text-dark text-uppercase bg-light border border-primary rounded-pill px-4 py-1 mb-3">International Shipping</small>
      <h1 class="display-5 mb-4">Global Delivery Services</h1>
      <p class="lead mb-4" *ngIf="username">Welcome back, {{username}}!</p>
    </div>
    
    <!-- Action Buttons -->
    <div class="row mb-4">
      <div class="col-md-12 text-center">
        <button class="btn btn-primary me-2 rounded-pill" (click)="navigateToPlaceOrder()">
          <i class="fas fa-plus-circle me-2"></i>Place New Order
        </button>
        <button class="btn btn-outline-primary me-2 rounded-pill" (click)="navigateToMyOrders()">
          <i class="fas fa-list me-2"></i>My Orders
        </button>
        <button class="btn btn-outline-primary rounded-pill" (click)="navigateToServiceList()">
          <i class="fas fa-truck me-2"></i>All Services
        </button>
      </div>
    </div>
  </div>
  
</div>

<!-- Filters Section -->
<div class="container mb-4">
  <div class="card shadow-sm">
    <div class="card-body">
      <h4 class="card-title mb-3">Filter Shipping Services</h4>
      <div class="row g-3">
        <div class="col-md-4">
          <div class="form-group">
            <label for="searchQuery" class="form-label">Search Services</label>
            <div class="input-group">
              <input 
                type="text" 
                class="form-control" 
                id="searchQuery" 
                [(ngModel)]="searchQuery" 
                placeholder="Search by carrier, country, or goods type..."
              >
              <button class="btn btn-primary" type="button" (click)="onSearch()">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="form-group">
            <label for="country" class="form-label">Destination Country</label>
            <select 
              class="form-select" 
              id="country" 
              (change)="onCountryChange($event)"
            >
              <option value="">All Countries</option>
              <option *ngFor="let country of countries" [value]="country">{{country}}</option>
            </select>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="form-group">
            <label for="maxPrice" class="form-label">Max Price</label>
            <input 
              type="number" 
              class="form-control" 
              id="maxPrice" 
              [(ngModel)]="maxPrice" 
              placeholder="Maximum price"
              (change)="onMaxPriceChange($event)"
            >
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Services Section -->
<div class="container-fluid service py-4">
  <div class="container">
    <div class="row mb-3">
      <div class="col">
        <h2 class="mb-0">Available Shipping Services</h2>
        <p class="text-muted">Found {{filteredServices.length}} of {{totalServices}} services</p>
      </div>
    </div>

    <!-- Loading and Error States -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3">Loading shipping services...</p>
    </div>

    <div *ngIf="error" class="alert alert-danger" role="alert">
      {{error}}
    </div>

    <!-- No Results Message -->
    <div *ngIf="!loading && !error && filteredServices.length === 0" class="text-center py-5">
      <i class="fas fa-search fa-4x text-muted mb-3"></i>
      <h4>No shipping services found</h4>
      <p>Try adjusting your filters or search criteria</p>
    </div>

    <!-- Services Grid -->
    <div class="row g-4" *ngIf="!loading && filteredServices.length > 0">
      <div class="col-lg-4 col-md-6 col-sm-12 wow bounceInUp" *ngFor="let service of filteredServices; let i = index" [attr.data-wow-delay]="'0.'+i+'s'">
        <div class="bg-light rounded service-item shadow-sm">
          <div class="service-content d-flex flex-column p-4">
            <div class="service-content-icon text-center mb-3">
              <i class="fas fa-shipping-fast fa-4x text-primary"></i>
            </div>
            <h4 class="mb-2">{{service.deliveryPersonName}}</h4>
            <div class="mb-3">
              <span class="badge bg-primary me-2">{{service.basePrice | currency}}</span>
              <span class="badge bg-info me-2" *ngIf="service.estimatedDeliveryDays">{{service.estimatedDeliveryDays}} days</span>
            </div>
            
            <div class="small mb-3">
              <div *ngIf="service.countriesServed && service.countriesServed.length > 0">
                <strong>Countries:</strong> 
                <span class="country-list">{{service.countriesServed.join(', ')}}</span>
              </div>
              <div *ngIf="service.acceptedGoodTypes && service.acceptedGoodTypes.length > 0">
                <strong>Accepted Goods:</strong> 
                <span>{{service.acceptedGoodTypes.join(', ')}}</span>
              </div>
            </div>
            
            <div class="d-grid mt-auto">
              <button class="btn btn-primary rounded-pill" (click)="placeOrder(service.serviceId)">
                Ship with this Service
              </button>
              <!-- Changed service.id to service.serviceId based on error messages -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Recent Orders Section -->
<div class="container mb-5" *ngIf="recentOrders && recentOrders.length > 0">
  <div class="card shadow-sm">
    <div class="card-body">
      <h4 class="card-title mb-3">Recent Orders</h4>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Date</th>
              <th>Service</th>
              <th>Destination</th>
              <th>Status</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of recentOrders">
              <td><strong>#{{order.orderId}}</strong></td>
              <td>{{order.orderDate | date}}</td>
              <td>{{order.serviceName}}</td>
              <td>{{order.destinationCountry}}</td>
              <td><span [ngClass]="getOrderStatusColor(order.status)">{{order.status}}</span></td>
              <td>{{order.totalPrice | currency}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="text-end">
        <button class="btn btn-outline-primary btn-sm rounded-pill" (click)="navigateToMyOrders()">
          View All Orders
        </button>
      </div>
    </div>
  </div>
</div>
<router-outlet></router-outlet>
