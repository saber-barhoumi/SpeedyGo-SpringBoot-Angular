<div class="container">
  <h2>Carpooling Management</h2>

  <!-- Toggle Form Button -->
  <button class="btn btn-primary mb-3" (click)="showForm = !showForm">
    {{ showForm ? 'Hide Form' : 'Add New Carpooling' }}
  </button>

  <!-- Carpooling Form -->
  <div *ngIf="showForm" class="card mb-3">
    <div class="card-body">
      <h3>{{ isEditing ? 'Edit Carpooling' : 'Create Carpooling' }}</h3>
      
      <form [formGroup]="carpoolingForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label>Departure Location</label>
            <select formControlName="departureLocation" class="form-control">
              <option value="">Select Departure</option>
              <option *ngFor="let gov of gouvernorats" [value]="gov">{{gov}}</option>
            </select>
          </div>
          
          <div class="col-md-6 mb-3">
            <label>Destination</label>
            <select formControlName="destination" class="form-control">
              <option value="">Select Destination</option>
              <option *ngFor="let gov of gouvernorats" [value]="gov">{{gov}}</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label>Distance (km)</label>
            <input type="number" formControlName="distanceKm" class="form-control" readonly>
          </div>
          
          <div class="col-md-6 mb-3">
            <label>Duration (minutes)</label>
            <input type="number" formControlName="durationMinutes" class="form-control" readonly>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label>Vehicle Type</label>
            <select formControlName="vehicleType" class="form-control">
              <option value="">Select Vehicle Type</option>
              <option *ngFor="let type of vehicleTypes" [value]="type">{{type}}</option>
            </select>
          </div>
          
          <div class="col-md-6 mb-3">
            <label>Fuel Type</label>
            <select formControlName="fuelType" class="form-control">
              <option value="">Select Fuel Type</option>
              <option *ngFor="let type of fuelTypes" [value]="type">{{type}}</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label>Available Seats</label>
            <input type="number" formControlName="availableSeats" class="form-control">
          </div>
          
          <div class="col-md-6 mb-3">
            <label>Weather Type</label>
            <select formControlName="weatherType" class="form-control">
              <option *ngFor="let type of weatherTypes" [value]="type">{{type}}</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <div class="form-check">
              <input type="checkbox" formControlName="wifi" class="form-check-input" id="wifiCheck" [value]="1">
              <label class="form-check-label" for="wifiCheck">Wifi Available</label>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <div class="form-check">
              <input type="checkbox" formControlName="airConditioning" class="form-check-input" id="acCheck" [value]="1">
              <label class="form-check-label" for="acCheck">Air Conditioning</label>
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label>Description</label>
          <textarea formControlName="description" class="form-control" rows="3"></textarea>
        </div>

        <!-- Price Calculation -->
        <div class="mb-3">
          <button type="button" class="btn btn-secondary" (click)="calculatePrice()" 
                  [disabled]="carpoolingForm.invalid">
            Calculate Price
          </button>
          
          <div *ngIf="calculatedPrice" class="mt-2">
            <strong>Calculated Price: {{ calculatedPrice | currency }}</strong>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="d-flex justify-content-between">
          <button type="submit" class="btn btn-primary" 
                  [disabled]="carpoolingForm.invalid || !calculatedPrice">
            {{ isEditing ? 'Update' : 'Create' }} Carpooling
          </button>
          
          <button type="button" class="btn btn-secondary" (click)="resetForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Carpoolings List -->
  <div class="card">
    <div class="card-body">
      <h3>Available Carpoolings</h3>
      
      <table class="table table-striped" *ngIf="carpoolings.length > 0">
        <thead>
          <tr>
            <th>Departure</th>
            <th>Destination</th>
            <th>Distance (km)</th>
            <th>Duration (min)</th>
            <th>Vehicle</th>
            <th>Seats</th>
            <th>Price/Seat</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let carpooling of carpoolings">
            <td>{{ carpooling.departureLocation }}</td>
            <td>{{ carpooling.destination }}</td>
            <td>{{ carpooling.distanceKm }}</td>